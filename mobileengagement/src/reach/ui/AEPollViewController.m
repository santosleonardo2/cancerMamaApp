/*
 * Copyright (c) Microsoft Corporation. All rights reserved.
 */

#import "AEPollViewController.h"
#import "AEViewControllerUtil.h"
#import "AEReachPoll.h"

@implementation AEPollViewController

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark Memory management
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

- (instancetype)initWithPoll:(AEReachPoll*)reachPoll
{
  self = [super initWithNibName:@"DefaultPollView" bundle:nil];
  if (self != nil)
  {
    self.poll = [reachPoll retain];
  }
  return self;
}

- (void)dealloc
{
  [self.poll exitContent];
  self.poll = nil;
  [super dealloc];
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark Actions
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

- (void)submitAnswers:(NSDictionary*)answers
{
  for (NSString* questionId in [answers allKeys])
    [self.poll fillAnswerWithQuestionId:questionId choiceId:answers[questionId]];

  [self.poll actionContent];
  [AEViewControllerUtil dismissViewController:self animated:YES];
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
#pragma mark Abstract method implementation
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

- (AEInteractiveContent*)content
{
  return self.poll;
}

@end
